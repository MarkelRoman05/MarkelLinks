<div class="container">
  <nav class="navbar">
    <div class="navbar-container">
      <div class="navbar-logo">
        <img
          src="images/balon.png"
          alt="Logo"
          class="logo"
          width="50"
          height="60"
        />
      </div>
      <div class="navbar-title">
        <h1>ACE STREAM LINKS</h1>
      </div>
    </div>
    <div class="time-clock">
      <i class="bi bi-clock"></i>
      <iframe
        src="https://free.timeanddate.com/clock/i9n4hxch/n327/tles4/fn12/fs18/fcfff/tc000/pcccc/ftb/bls0/brs0/bts4/th1"
        frameborder="0"
        width="92"
        height="25"
      ></iframe>
    </div>
  </nav>

  <div class="scroll-to-links" *ngIf="isMobile">
    <button class="scroll-to-links-button" (click)="scrollToLinks()">
      <i class="bi bi-arrow-down-short" style="font-size: x-large"></i>
      <span>Pulsa aquí para ir a los enlaces</span>
      <i class="bi bi-arrow-down-short" style="font-size: x-large"></i>
    </button>
  </div>
  <h3 class="agenda-header">AGENDA DEPORTIVA</h3>
  <div class="mini-separator"></div>
  <div class="futbol-tv-agendas">
    <div class="iframe-container">
      <div class="spinner-container" *ngIf="loading[0]">
        <mat-spinner diameter="78"></mat-spinner>
      </div>
      <iframe
        id="ftv_iframe_0"
        name="ftv_iframe_0"
        src="https://widgets.futbolenlatv.com/partidos/competition/la-liga?color=007eff&culture=es-ES"
        width="400"
        height="401"
        frameborder="0"
        scrolling="auto"
        style="margin-bottom: 10px"
        (load)="onIframeLoad(0)"
      ></iframe>
    </div>
    <div class="iframe-container">
      <div class="spinner-container" *ngIf="loading[1]">
        <mat-spinner diameter="78"></mat-spinner>
      </div>
      <iframe
        id="ftv_iframe_1"
        name="ftv_iframe_1"
        src="https://widgets.futbolenlatv.com/partidos/competition/liga-campeones?color=007eff&culture=es-ES"
        width="400"
        height="401"
        frameborder="0"
        scrolling="auto"
        style="margin-bottom: 10px"
        (load)="onIframeLoad(1)"
      ></iframe>
    </div>
    <div class="iframe-container">
      <div class="spinner-container" *ngIf="loading[2]">
        <mat-spinner diameter="78"></mat-spinner>
      </div>
      <iframe
        id="ftv_iframe_2"
        name="ftv_iframe_2"
        src="https://widgets.futbolenlatv.com/partidos/competition/europa-league?color=007eff&culture=es-ES"
        width="400"
        height="401"
        frameborder="0"
        scrolling="auto"
        style="margin-bottom: 10px"
        (load)="onIframeLoad(2)"
      ></iframe>
    </div>
    <div class="iframe-container">
      <div class="spinner-container" *ngIf="loading[3]">
        <mat-spinner diameter="78"></mat-spinner>
      </div>
      <iframe
        id="ftv_iframe_3"
        name="ftv_iframe_3"
        src="https://widgets.futbolenlatv.com/partidos/equipo/athletic-club-de-bilbao?color=007eff&culture=es-ES"
        width="400"
        height="401"
        frameborder="0"
        scrolling="auto"
        style="margin-bottom: 10px"
        (load)="onIframeLoad(3)"
      ></iframe>
    </div>
    <div class="iframe-container">
      <div class="spinner-container" *ngIf="loading[4]">
        <mat-spinner diameter="78"></mat-spinner>
      </div>
      <iframe
        id="ftv_iframe"
        name="ftv_iframe"
        src="https://widgets.futbolenlatv.com/partidos/competition/premier-league?color=007eff&culture=es-ES"
        width="400"
        height="401"
        frameborder="0"
        scrolling="auto"
        style="margin-bottom: 10px"
        (load)="onIframeLoad(4)"
      ></iframe>
    </div>
  </div>

  <div>
    <app-agenda-evento-text></app-agenda-evento-text>
  </div>

  <h4 class="text-enlaces-agenda-completa">
    Para ver la agenda completa, visita la web de&nbsp;
    <a href="https://www.futbolenlatv.es/" class="link-futboltv" target="_blank"
      >Fútbol en la TV
      <span style="vertical-align: middle"
        ><sup><i class="bi bi-box-arrow-in-up-right"></i></sup></span
    ></a>
  </h4>

  <h3 class="header-enlaces">ENLACES</h3>
  <div class="mini-separator"></div>
  <div class="search-container">
    <form class="search-form">
      <input
        type="text"
        class="search-field"
        placeholder="Introduce el canal a buscar..."
        [(ngModel)]="searchTerm"
        (keyup)="filterLinks()"
        name="searchTerm"
      />
      <div class="delete-search-container" *ngIf="searchTerm">
        <button
          matTooltip="Borrar texto de búsqueda"
          matTooltipPosition="below"
          class="delete-search-button"
          (click)="deleteSearch()"
        >
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
    </form>
  </div>
  <p class="no-encontrado-text" *ngIf="filteredLinks.length === 0">
    <i class="bi bi-exclamation-triangle-fill"></i>&nbsp; No se encontraron
    canales.
  </p>
  <div class="links-container" *ngIf="filteredLinks.length > 0">
    <div class="column" *ngFor="let column of [0, 1, 2]">
      <li
        class="links"
        *ngFor="
          let link of filteredLinks
            | slice
              : column * (filteredLinks.length / 3)
              : (column + 1) * (filteredLinks.length / 3)
        "
      >
        <a
          href="{{ link.url }}"
          class="acestream-link"
          (click)="trackClick(link.title)"
        >
          <img [src]="link.img" class="logo-img" />
          &nbsp;
          <span>{{ link.title }}</span>
        </a>
        <button
          matTooltip="Copiar enlace"
          matTooltipPosition="right"
          class="copy-button"
          (click)="copyLink(link.url, link.title)"
        >
          <i
            class="bi bi-copy"
            style="font-size: 20px; display: block; margin: 3px"
          >
          </i>
        </button>
      </li>
    </div>
  </div>

  <div class="otra-web">
    <h2 style="color: white; text-align: center">OTRA WEB DE ENLACES</h2>
    <div class="mini-separator"></div>
    <p>
      En el caso de que el enlace que busques no funcione, puedes probar en esta
      web:
      <a
        href="https://www.socialcreator.com/xupimarc2/?s=289267&integ_ch=1"
        target="_blank"
        >HAZ CLIC PARA ACCEDER</a
      >
    </p>
  </div>

  <div class="how-to-play-container">
    <h3 class="how-to-play-header">CÓMO REPRODUCIR ENLACES ACE STREAM</h3>
    <div class="mini-separator"></div>
    <p class="how-to-play-text">
      Para reproducir los enlaces Ace Stream en tu dispositivo necesitas tener
      instalado Ace Stream Media. Si no lo tienes instalado, puedes descargarlo
      desde la página oficial de Ace Stream haciendo clic
      <a href="https://www.acestream.org/?page=products" target="_blank">aquí</a
      >, o desde
      <a
        href="https://play.google.com/store/apps/details?id=org.acestream.node"
        target="_blank"
        >Play Store</a
      >
      para Android. No se puede instalar Ace Stream en dispositivos iOS.
    </p>

    <h4 style="color: white; margin: 0 20px 20px 29px">Android</h4>
    <p class="how-to-play-text">
      Para reproducir los enlaces en tu dispositivo móvil, una vez instalado Ace
      Stream, puedes abrir el enlace haciendo clic en él directamente, lo que
      abrirá Ace Stream y reproducirá el contenido. También puedes copiar el
      enlace, abrir Ace Stream manualmente y pegar el enlace en el cuadro de
      texto "Enter content link".
    </p>

    <h4 style="color: white; margin: 0 20px 20px 29px">Windows</h4>
    <p class="how-to-play-text">
      Una vez instalado Ace Stream en Windows, tienes dos formas de reproducir
      los enlaces: la primera es copiar el enlace, abrir Ace Player manualmente
      y pegar el enlace en la opción "Medio"
      <i class="bi bi-arrow-right"></i> "Open Ace Stream Content ID". La segunda
      es haciendo clic directamente en el enlace, seleccionar Ace Player y
      esperar al anuncio para ver el contenido. <strong>Nota:</strong> Asegúrate
      de tener abierto Ace Stream Engine (ace_engine / Ace Stream HD), si no,
      ábrelo tú manualmente desde la ruta de instalación de Ace Stream
      (C:\Users\<i>tuusuario</i>\AppData\Roaming \ACEStream\engine y abre
      ace_engine.exe).
    </p>

    <p class="how-to-play-text">
      Para reproducir los enlaces correctamente en tu dispositivo, es
      recomendable cambiar ciertos parámetros en la configuración de Ace Stream
      y de Ace Player (solo en Windows). Primero, haz clic derecho sobre el
      icono de Ace Stream en la barra de tareas y selecciona "Options..." (En
      Android ir a la configuración). Allí, cambia los valores de "VOD buffer" a
      10 y "Live buffer" a 60. Después, en Ace Player, ve en la parte de arriba
      a "Herramientas"
      <i class="bi bi-arrow-right"></i> "Preferencias"
      <i class="bi bi-arrow-right"></i> "Vídeo" y en Desentrelazado selecciona
      "Automático" y Modo <i class="bi bi-arrow-right"></i> "Yadif (2x)".
    </p>

    <h3 class="how-to-play-header">ELIMINAR RETARDO DE EMISIÓN</h3>
    <div class="mini-separator"></div>

    <p class="how-to-play-text">
      Para evitar ver el contenido con retraso, es recomendable hacer esto en
      Ace Player cada vez que reproduces un enlace (haz clic en la imagen para
      ampliarla):
    </p>

    <div class="popup-image-container">
      <img
        src="images/retardo_ace_stream.jpg"
        alt="Example Image"
        class="popup-image"
        (click)="openImagePopup('images/retardo_ace_stream.jpg')"
        title="Haz clic para ampliar"
        style="
          cursor: pointer;
          width: 100%;
          max-width: 500px;
          display: block;
          margin: 0 auto;
        "
      />
    </div>

    <div
      class="image-popup"
      *ngIf="isImagePopupOpen"
      (click)="closeImagePopup()"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      "
    >
      <img
        [src]="popupImageUrl"
        alt="Popup Image"
        style="max-width: 90%; max-height: 90%"
      />
      <button
        (click)="closeImagePopup()"
        title="Cerrar imagen"
        style="
          position: absolute;
          top: 20px;
          right: 20px;
          background-color: #ff4d4d;
          color: white;
          border: none;
          border-radius: 50%;
          width: 30px;
          height: 30px;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          display: flex;
          justify-content: center;
          align-items: center;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          z-index: 1001;
          transition: background-color 0.3s ease, transform 0.2s ease;
        "
      >
        &times;
      </button>
    </div>
    <p class="how-to-play-text" style="margin-top: 1.1rem;">
      Para eliminar el retraso en dispositivos móviles, haz clic en el botón "Live" de Ace Player.
    </p>
  </div>

  <div id="contacto" class="contact-form">
    <h3>CONTACTO</h3>
    <div class="mini-separator"></div>
    <p>
      Si tienes alguna duda, sugerencia o lo que quieras, no dudes en
      contactarme.
    </p>
    <form #contactForm="ngForm" (ngSubmit)="sendEmail(contactForm)" novalidate>
      <div>
        <input
          type="text"
          name="name"
          placeholder="Nombre"
          required
          pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$"
          [(ngModel)]="contact.name"
          #name="ngModel"
        />
        <div *ngIf="name.invalid && name.touched" class="error">
          <span *ngIf="name.errors?.['required']"
            >El nombre es obligatorio.</span
          >
          <span *ngIf="name.errors?.['pattern']">
            El nombre solo puede contener letras.
          </span>
        </div>
      </div>
      <div>
        <input
          type="email"
          name="email"
          placeholder="Email"
          required
          email
          [(ngModel)]="contact.email"
          #email="ngModel"
        />
        <div *ngIf="email.invalid && email.touched" class="error">
          <span *ngIf="email.errors?.['required']"
            >El email es obligatorio.</span
          >
          <span *ngIf="email.errors?.['email']">El email no es válido.</span>
        </div>
      </div>
      <div>
        <textarea
          name="message"
          placeholder="Mensaje"
          required
          minlength="5"
          [(ngModel)]="contact.message"
          #message="ngModel"
          rows="4"
          style="resize: vertical"
        ></textarea>
        <div *ngIf="message.invalid && message.touched" class="error">
          <span *ngIf="message.errors?.['required']"
            >El mensaje es obligatorio.</span
          >
          <span *ngIf="message.errors?.['minlength']">
            El mensaje debe tener al menos 5 caracteres.
          </span>
        </div>
      </div>

      <button type="submit" [disabled]="contactForm.invalid">Enviar</button>
    </form>
  </div>

  <div class="footer">
    <span class="footer-text">Markel Links</span>
    <p class="footer-text">
      Todos los enlaces son obtenidos de fuentes externas.
    </p>
    <button class="scroll-to-top" (click)="scrollToTop()">
      Volver arriba <i class="bi bi-arrow-up arrow-top"></i>
    </button>
  </div>
</div>
